<h1>Message List</h1>
<div class="form">
    <form (ngSubmit)=" loadMessageList() ">
        <input type="number" name="date_begin" [(ngModel)]="stat_date_begin">
        <input type="number" name="date_end" [(ngModel)]="stat_date_end">
        <button type="submit">SUBMIT</button>
    </form>
</div>
<div class="loader" *ngIf=" loader.message ">
    <mat-spinner [diameter]="48"></mat-spinner>
    Loading...
</div>

<section class="message" *ngIf=" messages && !loader.message ">

    <!-- <div *ngFor="let g of a.keys(messages) ">
        <h3>{{g}}</h3>
        <ng-container *ngFor="let info of messages[g]">
            <a class="card" href="/schedule-table?idx_teacher={{info.ID}}" target="_blank">
                <span class="primary-photo" *ngIf="info['photoURL']">
                    <img src="{{info['photoURL']}}">
                </span>
                <span>{{ info['display_name'] }}</span>
            </a>
        </ng-container>
    </div> -->
    <div *ngFor="let g of a.keys(messages) ">
        <h3>{{g}}</h3>
        <table>
            <tr>
                <th>User</th>
                <th>Count</th>
            </tr>
            <tr *ngFor="let info of messages[g]">
                <td class="align-top text-center">
                    <a href="/schedule-table?idx_teacher={{info.ID}}" target="_blank">
                        <div class="primary-photo" *ngIf="info['photoURL']">
                            <img src="{{info['photoURL']}}">
                        </div>
                        <div>{{ info['display_name'] }}</div>
                    </a>
                </td>
                <td class="align-top text-center">
                    <div class="pointer icon-svg" (click)="info['showMessage'] = !info['showMessage'] ">
                        <span>{{ info.message_count }}</span>
                        <span *ngIf=" info.message_count && g =='withcenter' ">
                            <svg *ngIf=" !info['showMessage'] " xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z" class=""></path></svg>
                            <svg *ngIf=" info['showMessage'] " xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M512 464c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V200.724a48 48 0 0 1 18.387-37.776c24.913-19.529 45.501-35.365 164.2-121.511C199.412 29.17 232.797-.347 256 .003c23.198-.354 56.596 29.172 73.413 41.433 118.687 86.137 139.303 101.995 164.2 121.512A48 48 0 0 1 512 200.724V464zm-65.666-196.605c-2.563-3.728-7.7-4.595-11.339-1.907-22.845 16.873-55.462 40.705-105.582 77.079-16.825 12.266-50.21 41.781-73.413 41.43-23.211.344-56.559-29.143-73.413-41.43-50.114-36.37-82.734-60.204-105.582-77.079-3.639-2.688-8.776-1.821-11.339 1.907l-9.072 13.196a7.998 7.998 0 0 0 1.839 10.967c22.887 16.899 55.454 40.69 105.303 76.868 20.274 14.781 56.524 47.813 92.264 47.573 35.724.242 71.961-32.771 92.263-47.573 49.85-36.179 82.418-59.97 105.303-76.868a7.998 7.998 0 0 0 1.839-10.967l-9.071-13.196z" class=""></path></svg>
                        </span>
                    </div>
                </td>
                <td>
                    <table *ngIf=" info.message_count && info['showMessage'] ">
                        <tr *ngFor="let m of info.messages">
                            <td>
                                <a class="icon-svg link" href="/manager/user-info/{{m.receiver}}" target="_blank">{{m.receiver}}
                                    <svg _ngcontent-c5="" viewBox="0 0 576 512"><path _ngcontent-c5="" d="M195.515 374.828c-4.686-4.686-4.686-12.284 0-16.971l323.15-323.15-.707-.707-89.958.342c-6.627 0-12-5.373-12-12v-9.999c0-6.628 5.372-12 12-12L564 0c6.627 0 12 5.372 12 12l-.343 136c0 6.627-5.373 12-12 12h-9.999c-6.627 0-12-5.373-12-12L542 58.042l-.707-.707-323.15 323.15c-4.686 4.686-12.284 4.686-16.971 0l-5.657-5.657zm232-155.633l-8 8A12 12 0 0 0 416 235.68V464c0 8.837-7.164 16-16 16H48c-8.836 0-16-7.163-16-16V112c0-8.837 7.164-16 16-16h339.976c3.183 0 6.235-1.264 8.485-3.515l8-8c7.56-7.56 2.206-20.485-8.485-20.485H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V227.681c0-10.691-12.926-16.045-20.485-8.486z" fill="currentColor"></path></svg>
                                </a>
                            </td>
                            <td>
                                <!--<div>{{m.title}}</div>-->
                                <div>{{m.content}}</div>
                            </td>
                            <td>{{m.open > 0 ? 'Y' : 'N'}}</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

    </div>

</section>